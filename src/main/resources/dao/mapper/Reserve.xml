<?xml version="1.0" encoding="UTF-8" ?>
<!-- main/resources/dao/mapper/Reserve.xml -->
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="dao.mapper.ReserveMapper">

	<select id="count" resultType="Integer" parameterType="map">
		select count(*) from reserve 
		
		<if test="searchType != null and searchContent != null">
			where ${searchType} like '%${searchContent}%'	
		</if>
		
		<if test="id != null">
			where id = #{id}
		</if>
		
	</select>
		
	<select id="selectOne" resultType="Reserve" parameterType="map">
		select * from reserve
		<if test="reNo != null">
			where reNo = #{reNo}
		</if>
	</select>
	
	<select id="selectList" resultType="Reserve" parameterType="map">
		select * from Reserve 
		
		<if test="searchType != null and searchContent != null">
			where ${searchType} like '%${searchContent}%'
		</if>

		<if test="id != null">
			where id = #{id}
		</if>
	</select>
	
	
	<select id="hostCount" resultType="Integer" parameterType="map">
		select count(*) from reserve 
		
		<if test="searchType != null and searchContent != null and sNo != null">
			where ${searchType} like '%${searchContent}%' and sNo = #{sNo}
		</if>
		
		<if test="searchType == null and searchContent == null and sNo != null">
			where sNo = #{sNo}
		</if>
	</select>
	
	<!-- [&lt; : <] [&gt; : >] -->
	<select id="selectHostList" resultType="Reserve" parameterType="map">
		select * from Reserve 
		
		<if test="searchType != null and searchContent != null and startDate == null and endDate == null and sNo != null">
			where ${searchType} like '%${searchContent}%' and sNo = #{sNo}
		</if>
		
		<if test="searchType == null and searchContent == null and startDate == null and endDate == null and sNo != null">
			where sNo = #{sNo}
		</if>
		
		<if test="searchType == 'reDate' and searchContent == null and startDate != null and endDate != null and sNo != null">
			where reDate &gt; #{startDate} and reDate &lt; #{endDate} and sNo = #{sNo}
		</if>
		
		<if test="searchType == 'regDate' and searchContent == null and startDate != null and endDate != null and sNo != null">
			where regDate &gt; #{startDate} and regDate &lt; #{endDate} and sNo = #{sNo}
		</if>
		
	</select>
	
	<update id="cancel" parameterType="map">
		update Reserve set reStat = 
			<if test="reStat == 0">	4 </if>
			<if test="reStat == 1">	2 </if>
			<if test="reStat == 2">	3 </if>
		where reNo = #{reNo}
	</update>
	
	<update id="paymentConfirm" parameterType="map">
		update Reserve set reStat=1 where reNo = #{reNo}
	</update>
	
</mapper>